


<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>JSON Test</title>
</head>
<body>
    LP CERTIFICATION
    <div id="ver">rel 1140</div>
    <div id="appDiv"></div>
    <script>
        const appDiv = document.getElementById("appDiv");
        appDiv.innerHTML = "Response init";
pathToData = "chatTranscript.lines";
const updateCallback = function(data) {
console.log("***updateCallback****");
// Do something with the returning data
console.log("JSON DATA----------------------");
console.log(JSON.stringify(data));
// const path = data.key;
const value = data.newValue;
const index = value.length - 1;
const messageObj = value[index];
    var url ="http://www.omdbapi.com/?t=terminator&apikey=c2eec5ec";
//if (messageObj.source === "visitor") 
    if(true)
{
//fetch("https://www.omdbapi.com?t=" + messageObj.text + "&apikey=c2eec5ec")
 appDiv.innerHTML = appDiv+" fetching...";
    fetch(url) 
.then(response => {
    if (!response.ok) { 
    throw response }
    return response.json()  //we only get here if there is no error
  })
.then(json => {
     document.querySelector("#ver").innerText = json.sentence
console.log("RESULT-------------------------")
console.log(json)
if (json.Response === "True") 
{
   
appDiv.innerHTML =
"<div>Title: " +
json.Title +
"</div> <div>Year: " +
json.Year +
"</div> <div>Rated: " +
json.Rated +
"</div> <div>Released: " +
json.Released +
"</div> <div>Runtime: " +
json.Runtime +
"</div> <div>Genre: " +
json.Genre +
"</div> <div>Director: " +
json.Director +
"</div> <div>Actors: " +
json.Actors +
"</div> <div>Plot: " +
json.Plot +
"</div> <div>Awards: " +
json.Awards +
"</div> <div>imdbRating: " +
json.imdbRating +
"</div>";
} else {
appDiv.innerHTML = json.Error;
}
})
.catch(err => {
console.log(err);
});
}
// called each time the value is updated.
// If there's an existing value when bind is called - this callback
// will be called with the existing value
};
const notifyWhenDone = function(err) {
if (err) {
// Do something with the error
console.log("error", err);
}
// called when the bind is completed successfully,
// or when the action terminated with an error.
};
lpTag.agentSDK.init({});
lpTag.agentSDK.bind(pathToData, updateCallback, notifyWhenDone);
    
        var errorMsg = function(error) {
    if (err){ console.log("-------------- errorMsg function : "+err);    }
    var chatText = "chatTranscript.lines";
    errorMessage.innerHTML = "Movie not found.";
    };
    </script>
</body>
</html>
